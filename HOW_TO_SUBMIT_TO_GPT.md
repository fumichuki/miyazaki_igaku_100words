# 📤 GPTへの投げ方ガイド

## ✅ 準備完了

以下のファイルを作成しました：
- **GPT_SUBMISSION.txt** - 不具合レポート + 全コード（1200行以上）

---

## 🎯 ChatGPT / Claude への投げ方

### 方法1: ファイルをそのままアップロード（推奨）

1. **GPT_SUBMISSION.txt** をダウンロード
2. ChatGPT または Claude の新しいチャットを開始
3. ファイルをドラッグ&ドロップ
4. 以下のプロンプトを入力：

```
添付ファイルには、英語添削システムの不具合レポートと関連コードが含まれています。

【不具合の概要】
1. 文分割が過剰（3文が6文に分割される）
2. LLMが未提出の文に対して無関係な解説を生成
3. 日本語訳の表示が不完全

【質問】
以下の3つの修正案を提案してください：

1. **文分割ロジックの修正（最優先）**
   - points_normalizer.py の normalize_user_input() と split_into_sentences() を修正
   - ピリオド直後の大文字のみを文の開始と見なす
   - 小文字始まりは前の文の継続と見なす
   - 改行は文の区切りとして尊重するが、末尾に句読点がない場合は次の行と結合
   
2. **「未提出」の処理を明確化**
   - prompts_translation_simple.py にプロンプトを追加
   - 未提出の文に対して模範解答を生成しない
   - 無関係な語彙解説を出さない
   
3. **日本語訳の表示を徹底**
   - reasonフォーマットで「N文目: （日本語訳）」を必ず含める
   - 未提出の場合も「（日本語訳: ...）」を含める

【制約条件】
- 既存のテストケースは全て通過すること
- 新しい不具合を導入しないこと
- パフォーマンスへの影響は最小限にすること

【期待する出力】
- 修正後の points_normalizer.py の該当部分（完全なコード）
- 修正後の prompts_translation_simple.py の追加部分（完全なプロンプト）
- 修正の理由と影響範囲の説明
```

---

### 方法2: 段階的に投げる（ファイルサイズが大きい場合）

#### ステップ1: 不具合レポートを投げる

```bash
# 不具合レポートのみを抽出
head -300 GPT_SUBMISSION.txt > REPORT_ONLY.txt
```

プロンプト:
```
以下は英語添削システムの不具合レポートです。まず内容を理解して、質問があれば教えてください。

（ファイルをアップロードまたは貼り付け）
```

#### ステップ2: コードを投げる

プロンプト:
```
それでは、修正が必要なコードを共有します。以下のファイルを確認してください：
- points_normalizer.py（文分割ロジック）
- constraint_validator.py（句読点正規化）
- prompts_translation_simple.py（プロンプト定義）

（残りの部分をアップロードまたは貼り付け）
```

#### ステップ3: 修正を依頼

プロンプト:
```
不具合レポートとコードを確認していただきありがとうございます。

以下の優先順位で修正案を提案してください：

1. **P0（最優先）**: 文分割ロジックの修正
   - 3つのアプローチ（保守的・中間・積極的）を比較
   - 推奨案を1つ選んで、完全な修正コードを提供
   
2. **P1（高優先）**: 「未提出」の処理明確化
   - プロンプトの追加箇所と内容を提案
   
3. **P2（中優先）**: 日本語訳の表示徹底
   - reasonフォーマットの改善案

修正コードは、そのまま置き換え可能な形式で提供してください。
```

---

## 📊 ファイルの内容

### GPT_SUBMISSION.txt の構造

```
1. 不具合レポート（約300行）
   - 不具合1: 文分割が過剰
   - 不具合2: 無関係な解説生成
   - 不具合3: 日本語訳の欠落
   - 推奨される修正方針
   - テスト結果の詳細

2. コードファイル（約900行）
   - points_normalizer.py（378行）
   - constraint_validator.py（386行）
   - test_sentence_split_debug.py（約70行）
   - prompts_translation_simple.py（抜粋150行）
```

---

## 🔍 確認コマンド

```bash
# ファイルの行数確認
wc -l GPT_SUBMISSION.txt

# ファイルサイズ確認
ls -lh GPT_SUBMISSION.txt

# 内容のプレビュー（最初の100行）
head -100 GPT_SUBMISSION.txt

# セクション区切りを確認
grep "===" GPT_SUBMISSION.txt
```

---

## ✨ Tips

### ChatGPT での使い方
- **GPT-4** を使用（GPT-3.5 では長いコードの理解が難しい）
- Code Interpreter を有効にすると、コードの検証が可能
- 複数回に分けて質問する場合は、同じチャット内で継続

### Claude での使い方
- **Claude 3 Opus または Sonnet** を推奨
- Claude は長文の理解が得意なので、一度に全て投げてOK
- 「日本語で回答してください」と明記すると良い

### 重要な注意点
1. **GPT の回答は必ず確認**してからコードに適用
2. **既存のテストを実行**して、回帰がないか確認
3. **段階的にコミット**して、問題があればロールバック可能に

---

## 🎬 実行例

```bash
# GPT から修正コードを受け取ったら

# 1. バックアップを作成
cp points_normalizer.py points_normalizer.py.backup

# 2. 修正を適用
# （GPTの回答をコピー&ペーストまたはファイル置き換え）

# 3. テストを実行
python test_sentence_split_debug.py
python test_user_input_validation.py

# 4. サーバーを再起動
bash restart_server.sh

# 5. 動作確認

# 6. 問題なければコミット
git add .
git commit -m "fix: 文分割ロジックを修正（GPT-4提案）"
git push
```

---

## 📌 次のステップ

1. ✅ **GPT_SUBMISSION.txt** を ChatGPT / Claude に投げる
2. ⏳ 修正案を受け取る
3. ⏳ 修正コードを適用
4. ⏳ テストで検証
5. ⏳ GitHubにコミット

---

**作成日**: 2026年1月29日
**ファイルパス**: `/workspaces/miyazaki_igaku_100words/GPT_SUBMISSION.txt`
